{
  "gherkinDocuments": [
    {
      "type": "GherkinDocument",
      "feature": {
        "type": "Feature",
        "tags": [],
        "location": {
          "line": 1,
          "column": 1
        },
        "language": "en",
        "keyword": "Feature",
        "name": "",
        "description": "    Test the Apigee proxy to make sure that it correctly utilizes Security policies",
        "children": [
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 4,
              "column": 3
            },
            "keyword": "Scenario",
            "name": "Verify API Key",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 5,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I set query parameters to",
                "argument": {
                  "type": "DataTable",
                  "location": {
                    "line": 6,
                    "column": 13
                  },
                  "rows": [
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 6,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 6,
                            "column": 15
                          },
                          "value": "parameter"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 6,
                            "column": 29
                          },
                          "value": "value"
                        }
                      ]
                    },
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 7,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 7,
                            "column": 15
                          },
                          "value": "apikey"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 7,
                            "column": 29
                          },
                          "value": "`clientId`"
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "type": "Step",
                "location": {
                  "line": 8,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /verifyapikey"
              },
              {
                "type": "Step",
                "location": {
                  "line": 9,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 200"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 11,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Verify Incorrect API Key",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 12,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I set query parameters to",
                "argument": {
                  "type": "DataTable",
                  "location": {
                    "line": 13,
                    "column": 13
                  },
                  "rows": [
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 13,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 13,
                            "column": 15
                          },
                          "value": "parameter"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 13,
                            "column": 28
                          },
                          "value": "value"
                        }
                      ]
                    },
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 14,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 14,
                            "column": 15
                          },
                          "value": "apikey"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 14,
                            "column": 28
                          },
                          "value": "abcdefghijklmnopqrstuvwxyz1234567"
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "type": "Step",
                "location": {
                  "line": 15,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /verifyapikey"
              },
              {
                "type": "Step",
                "location": {
                  "line": 16,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 401"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 18,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Authorize API Key",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 19,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I have basic authentication credentials `clientId` and `clientSecret`"
              },
              {
                "type": "Step",
                "location": {
                  "line": 20,
                  "column": 11
                },
                "keyword": "And ",
                "text": "I set query parameters to",
                "argument": {
                  "type": "DataTable",
                  "location": {
                    "line": 21,
                    "column": 13
                  },
                  "rows": [
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 21,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 21,
                            "column": 15
                          },
                          "value": "parameter"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 21,
                            "column": 28
                          },
                          "value": "value"
                        }
                      ]
                    },
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 22,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 22,
                            "column": 15
                          },
                          "value": "grant_type"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 22,
                            "column": 28
                          },
                          "value": "client_credentials"
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "type": "Step",
                "location": {
                  "line": 23,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /authorizeapikey"
              },
              {
                "type": "Step",
                "location": {
                  "line": 24,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 200"
              },
              {
                "type": "Step",
                "location": {
                  "line": 25,
                  "column": 11
                },
                "keyword": "And ",
                "text": "I store the value of body path $.access_token as valid_token in global scope"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 27,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Fail to authorize invalid API Key",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 28,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I have basic authentication credentials abcdefghijklmnopqrstuvwxyz1234567 and abcdefg123456"
              },
              {
                "type": "Step",
                "location": {
                  "line": 29,
                  "column": 11
                },
                "keyword": "And ",
                "text": "I set query parameters to",
                "argument": {
                  "type": "DataTable",
                  "location": {
                    "line": 30,
                    "column": 13
                  },
                  "rows": [
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 30,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 30,
                            "column": 15
                          },
                          "value": "parameter"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 30,
                            "column": 28
                          },
                          "value": "value"
                        }
                      ]
                    },
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 31,
                        "column": 13
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 31,
                            "column": 15
                          },
                          "value": "grant_type"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 31,
                            "column": 28
                          },
                          "value": "client_credentials"
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "type": "Step",
                "location": {
                  "line": 32,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /authorizeapikey"
              },
              {
                "type": "Step",
                "location": {
                  "line": 33,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 401"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 35,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Verify Access Token",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 36,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I set Authorization header to Bearer `valid_token`"
              },
              {
                "type": "Step",
                "location": {
                  "line": 37,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /verifyoauth"
              },
              {
                "type": "Step",
                "location": {
                  "line": 38,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 200"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 40,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Restrict access with invalid Access Token",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 41,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I set Authorization header to Bearer abcdefghijklmnopqrstuvwxyz12"
              },
              {
                "type": "Step",
                "location": {
                  "line": 42,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /verifyoauth"
              },
              {
                "type": "Step",
                "location": {
                  "line": 43,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 401"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 45,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Verify OAuth Scope",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 46,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I set Authorization header to Bearer `valid_token`"
              },
              {
                "type": "Step",
                "location": {
                  "line": 47,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /oauthscope"
              },
              {
                "type": "Step",
                "location": {
                  "line": 48,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 200"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 50,
              "column": 5
            },
            "keyword": "Scenario",
            "name": "Restrict access with Invalid Access Token scope",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 51,
                  "column": 9
                },
                "keyword": "Given ",
                "text": "I set Authorization header to Bearer abcdefghijklmnopqrstuvwxyz12"
              },
              {
                "type": "Step",
                "location": {
                  "line": 52,
                  "column": 10
                },
                "keyword": "When ",
                "text": "I GET /oauthscope"
              },
              {
                "type": "Step",
                "location": {
                  "line": 53,
                  "column": 10
                },
                "keyword": "Then ",
                "text": "response code should be 401"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 55,
              "column": 6
            },
            "keyword": "Scenario",
            "name": "Deny requests when malicious SQL code is sent as Query Param",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 56,
                  "column": 10
                },
                "keyword": "Given ",
                "text": "I set query parameters to",
                "argument": {
                  "type": "DataTable",
                  "location": {
                    "line": 57,
                    "column": 14
                  },
                  "rows": [
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 57,
                        "column": 14
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 57,
                            "column": 16
                          },
                          "value": "parameter"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 57,
                            "column": 28
                          },
                          "value": "value"
                        }
                      ]
                    },
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 58,
                        "column": 14
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 58,
                            "column": 16
                          },
                          "value": "sqlcode"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 58,
                            "column": 28
                          },
                          "value": "SELECT * FROM Users; DROP TABLE Users"
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "type": "Step",
                "location": {
                  "line": 59,
                  "column": 11
                },
                "keyword": "When ",
                "text": "I GET /sql"
              },
              {
                "type": "Step",
                "location": {
                  "line": 60,
                  "column": 11
                },
                "keyword": "Then ",
                "text": "response code should be 500"
              }
            ]
          },
          {
            "type": "Scenario",
            "tags": [],
            "location": {
              "line": 62,
              "column": 6
            },
            "keyword": "Scenario",
            "name": "Log requests with API Keys",
            "steps": [
              {
                "type": "Step",
                "location": {
                  "line": 63,
                  "column": 10
                },
                "keyword": "Given ",
                "text": "I set User-Agent header to apickli"
              },
              {
                "type": "Step",
                "location": {
                  "line": 64,
                  "column": 12
                },
                "keyword": "And ",
                "text": "I set query parameters to",
                "argument": {
                  "type": "DataTable",
                  "location": {
                    "line": 65,
                    "column": 14
                  },
                  "rows": [
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 65,
                        "column": 14
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 65,
                            "column": 16
                          },
                          "value": "parameter"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 65,
                            "column": 28
                          },
                          "value": "value"
                        }
                      ]
                    },
                    {
                      "type": "TableRow",
                      "location": {
                        "line": 66,
                        "column": 14
                      },
                      "cells": [
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 66,
                            "column": 16
                          },
                          "value": "apikey"
                        },
                        {
                          "type": "TableCell",
                          "location": {
                            "line": 66,
                            "column": 28
                          },
                          "value": "`clientId`"
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "type": "Step",
                "location": {
                  "line": 67,
                  "column": 11
                },
                "keyword": "When ",
                "text": "I GET /logapikey"
              },
              {
                "type": "Step",
                "location": {
                  "line": 68,
                  "column": 11
                },
                "keyword": "Then ",
                "text": "response code should be 200"
              }
            ]
          }
        ]
      },
      "comments": [],
      "uri": "features/security-test.feature"
    }
  ],
  "pickles": [
    {
      "tags": [],
      "name": "Verify API Key",
      "language": "en",
      "locations": [
        {
          "line": 4,
          "column": 3
        }
      ],
      "steps": [
        {
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                {
                  "cells": [
                    {
                      "location": {
                        "line": 6,
                        "column": 15
                      },
                      "value": "parameter"
                    },
                    {
                      "location": {
                        "line": 6,
                        "column": 29
                      },
                      "value": "value"
                    }
                  ]
                },
                {
                  "cells": [
                    {
                      "location": {
                        "line": 7,
                        "column": 15
                      },
                      "value": "apikey"
                    },
                    {
                      "location": {
                        "line": 7,
                        "column": 29
                      },
                      "value": "`clientId`"
                    }
                  ]
                }
              ]
            }
          ],
          "locations": [
            {
              "line": 5,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /verifyapikey",
          "arguments": [],
          "locations": [
            {
              "line": 8,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 200",
          "arguments": [],
          "locations": [
            {
              "line": 9,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Verify Incorrect API Key",
      "language": "en",
      "locations": [
        {
          "line": 11,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                {
                  "cells": [
                    {
                      "location": {
                        "line": 13,
                        "column": 15
                      },
                      "value": "parameter"
                    },
                    {
                      "location": {
                        "line": 13,
                        "column": 28
                      },
                      "value": "value"
                    }
                  ]
                },
                {
                  "cells": [
                    {
                      "location": {
                        "line": 14,
                        "column": 15
                      },
                      "value": "apikey"
                    },
                    {
                      "location": {
                        "line": 14,
                        "column": 28
                      },
                      "value": "abcdefghijklmnopqrstuvwxyz1234567"
                    }
                  ]
                }
              ]
            }
          ],
          "locations": [
            {
              "line": 12,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /verifyapikey",
          "arguments": [],
          "locations": [
            {
              "line": 15,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 401",
          "arguments": [],
          "locations": [
            {
              "line": 16,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Authorize API Key",
      "language": "en",
      "locations": [
        {
          "line": 18,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I have basic authentication credentials `clientId` and `clientSecret`",
          "arguments": [],
          "locations": [
            {
              "line": 19,
              "column": 15
            }
          ]
        },
        {
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                {
                  "cells": [
                    {
                      "location": {
                        "line": 21,
                        "column": 15
                      },
                      "value": "parameter"
                    },
                    {
                      "location": {
                        "line": 21,
                        "column": 28
                      },
                      "value": "value"
                    }
                  ]
                },
                {
                  "cells": [
                    {
                      "location": {
                        "line": 22,
                        "column": 15
                      },
                      "value": "grant_type"
                    },
                    {
                      "location": {
                        "line": 22,
                        "column": 28
                      },
                      "value": "client_credentials"
                    }
                  ]
                }
              ]
            }
          ],
          "locations": [
            {
              "line": 20,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /authorizeapikey",
          "arguments": [],
          "locations": [
            {
              "line": 23,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 200",
          "arguments": [],
          "locations": [
            {
              "line": 24,
              "column": 15
            }
          ]
        },
        {
          "text": "I store the value of body path $.access_token as valid_token in global scope",
          "arguments": [],
          "locations": [
            {
              "line": 25,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Fail to authorize invalid API Key",
      "language": "en",
      "locations": [
        {
          "line": 27,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I have basic authentication credentials abcdefghijklmnopqrstuvwxyz1234567 and abcdefg123456",
          "arguments": [],
          "locations": [
            {
              "line": 28,
              "column": 15
            }
          ]
        },
        {
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                {
                  "cells": [
                    {
                      "location": {
                        "line": 30,
                        "column": 15
                      },
                      "value": "parameter"
                    },
                    {
                      "location": {
                        "line": 30,
                        "column": 28
                      },
                      "value": "value"
                    }
                  ]
                },
                {
                  "cells": [
                    {
                      "location": {
                        "line": 31,
                        "column": 15
                      },
                      "value": "grant_type"
                    },
                    {
                      "location": {
                        "line": 31,
                        "column": 28
                      },
                      "value": "client_credentials"
                    }
                  ]
                }
              ]
            }
          ],
          "locations": [
            {
              "line": 29,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /authorizeapikey",
          "arguments": [],
          "locations": [
            {
              "line": 32,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 401",
          "arguments": [],
          "locations": [
            {
              "line": 33,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Verify Access Token",
      "language": "en",
      "locations": [
        {
          "line": 35,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I set Authorization header to Bearer `valid_token`",
          "arguments": [],
          "locations": [
            {
              "line": 36,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /verifyoauth",
          "arguments": [],
          "locations": [
            {
              "line": 37,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 200",
          "arguments": [],
          "locations": [
            {
              "line": 38,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Restrict access with invalid Access Token",
      "language": "en",
      "locations": [
        {
          "line": 40,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I set Authorization header to Bearer abcdefghijklmnopqrstuvwxyz12",
          "arguments": [],
          "locations": [
            {
              "line": 41,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /verifyoauth",
          "arguments": [],
          "locations": [
            {
              "line": 42,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 401",
          "arguments": [],
          "locations": [
            {
              "line": 43,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Verify OAuth Scope",
      "language": "en",
      "locations": [
        {
          "line": 45,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I set Authorization header to Bearer `valid_token`",
          "arguments": [],
          "locations": [
            {
              "line": 46,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /oauthscope",
          "arguments": [],
          "locations": [
            {
              "line": 47,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 200",
          "arguments": [],
          "locations": [
            {
              "line": 48,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Restrict access with Invalid Access Token scope",
      "language": "en",
      "locations": [
        {
          "line": 50,
          "column": 5
        }
      ],
      "steps": [
        {
          "text": "I set Authorization header to Bearer abcdefghijklmnopqrstuvwxyz12",
          "arguments": [],
          "locations": [
            {
              "line": 51,
              "column": 15
            }
          ]
        },
        {
          "text": "I GET /oauthscope",
          "arguments": [],
          "locations": [
            {
              "line": 52,
              "column": 15
            }
          ]
        },
        {
          "text": "response code should be 401",
          "arguments": [],
          "locations": [
            {
              "line": 53,
              "column": 15
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Deny requests when malicious SQL code is sent as Query Param",
      "language": "en",
      "locations": [
        {
          "line": 55,
          "column": 6
        }
      ],
      "steps": [
        {
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                {
                  "cells": [
                    {
                      "location": {
                        "line": 57,
                        "column": 16
                      },
                      "value": "parameter"
                    },
                    {
                      "location": {
                        "line": 57,
                        "column": 28
                      },
                      "value": "value"
                    }
                  ]
                },
                {
                  "cells": [
                    {
                      "location": {
                        "line": 58,
                        "column": 16
                      },
                      "value": "sqlcode"
                    },
                    {
                      "location": {
                        "line": 58,
                        "column": 28
                      },
                      "value": "SELECT * FROM Users; DROP TABLE Users"
                    }
                  ]
                }
              ]
            }
          ],
          "locations": [
            {
              "line": 56,
              "column": 16
            }
          ]
        },
        {
          "text": "I GET /sql",
          "arguments": [],
          "locations": [
            {
              "line": 59,
              "column": 16
            }
          ]
        },
        {
          "text": "response code should be 500",
          "arguments": [],
          "locations": [
            {
              "line": 60,
              "column": 16
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    },
    {
      "tags": [],
      "name": "Log requests with API Keys",
      "language": "en",
      "locations": [
        {
          "line": 62,
          "column": 6
        }
      ],
      "steps": [
        {
          "text": "I set User-Agent header to apickli",
          "arguments": [],
          "locations": [
            {
              "line": 63,
              "column": 16
            }
          ]
        },
        {
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                {
                  "cells": [
                    {
                      "location": {
                        "line": 65,
                        "column": 16
                      },
                      "value": "parameter"
                    },
                    {
                      "location": {
                        "line": 65,
                        "column": 28
                      },
                      "value": "value"
                    }
                  ]
                },
                {
                  "cells": [
                    {
                      "location": {
                        "line": 66,
                        "column": 16
                      },
                      "value": "apikey"
                    },
                    {
                      "location": {
                        "line": 66,
                        "column": 28
                      },
                      "value": "`clientId`"
                    }
                  ]
                }
              ]
            }
          ],
          "locations": [
            {
              "line": 64,
              "column": 16
            }
          ]
        },
        {
          "text": "I GET /logapikey",
          "arguments": [],
          "locations": [
            {
              "line": 67,
              "column": 16
            }
          ]
        },
        {
          "text": "response code should be 200",
          "arguments": [],
          "locations": [
            {
              "line": 68,
              "column": 16
            }
          ]
        }
      ],
      "uri": "features/security-test.feature"
    }
  ],
  "testCaseAttempts": [
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Verify API Key",
        "result": {
          "duration": 436000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 4
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 5000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 4000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 67
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 5
          },
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                [
                  "parameter",
                  "value"
                ],
                [
                  "apikey",
                  "`clientId`"
                ]
              ]
            }
          ]
        },
        {
          "attachments": [],
          "result": {
            "duration": 423000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 8
          },
          "text": "I GET /verifyapikey",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 9
          },
          "text": "response code should be 200",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Verify Incorrect API Key",
        "result": {
          "duration": 152000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 11
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 67
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 12
          },
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                [
                  "parameter",
                  "value"
                ],
                [
                  "apikey",
                  "abcdefghijklmnopqrstuvwxyz1234567"
                ]
              ]
            }
          ]
        },
        {
          "attachments": [],
          "result": {
            "duration": 148000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 15
          },
          "text": "I GET /verifyapikey",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 16
          },
          "text": "response code should be 401",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Authorize API Key",
        "result": {
          "duration": 161000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 18
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 77
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 19
          },
          "text": "I have basic authentication credentials `clientId` and `clientSecret`",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 67
          },
          "keyword": "And ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 20
          },
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                [
                  "parameter",
                  "value"
                ],
                [
                  "grant_type",
                  "client_credentials"
                ]
              ]
            }
          ]
        },
        {
          "attachments": [],
          "result": {
            "duration": 146000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 23
          },
          "text": "I GET /authorizeapikey",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 24
          },
          "text": "response code should be 200",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 9000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 253
          },
          "keyword": "And ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 25
          },
          "text": "I store the value of body path $.access_token as valid_token in global scope",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Fail to authorize invalid API Key",
        "result": {
          "duration": 175000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 27
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 0,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 9000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 77
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 28
          },
          "text": "I have basic authentication credentials abcdefghijklmnopqrstuvwxyz1234567 and abcdefg123456",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 67
          },
          "keyword": "And ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 29
          },
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                [
                  "parameter",
                  "value"
                ],
                [
                  "grant_type",
                  "client_credentials"
                ]
              ]
            }
          ]
        },
        {
          "attachments": [],
          "result": {
            "duration": 162000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 32
          },
          "text": "I GET /authorizeapikey",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 33
          },
          "text": "response code should be 401",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Verify Access Token",
        "result": {
          "duration": 312000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 35
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 37
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 36
          },
          "text": "I set Authorization header to Bearer `valid_token`",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 304000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 37
          },
          "text": "I GET /verifyoauth",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 38
          },
          "text": "response code should be 200",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Restrict access with invalid Access Token",
        "result": {
          "duration": 163000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 40
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 37
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 41
          },
          "text": "I set Authorization header to Bearer abcdefghijklmnopqrstuvwxyz12",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 157000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 42
          },
          "text": "I GET /verifyoauth",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 43
          },
          "text": "response code should be 401",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Verify OAuth Scope",
        "result": {
          "duration": 122000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 45
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 37
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 46
          },
          "text": "I set Authorization header to Bearer `valid_token`",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 116000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 47
          },
          "text": "I GET /oauthscope",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 48
          },
          "text": "response code should be 200",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Restrict access with Invalid Access Token scope",
        "result": {
          "duration": 135000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 50
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 37
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 51
          },
          "text": "I set Authorization header to Bearer abcdefghijklmnopqrstuvwxyz12",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 130000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 52
          },
          "text": "I GET /oauthscope",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 53
          },
          "text": "response code should be 401",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Deny requests when malicious SQL code is sent as Query Param",
        "result": {
          "duration": 121000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 55
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 2000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 67
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 56
          },
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                [
                  "parameter",
                  "value"
                ],
                [
                  "sqlcode",
                  "SELECT * FROM Users; DROP TABLE Users"
                ]
              ]
            }
          ]
        },
        {
          "attachments": [],
          "result": {
            "duration": 117000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 59
          },
          "text": "I GET /sql",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 0,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 60
          },
          "text": "response code should be 500",
          "arguments": []
        }
      ]
    },
    {
      "testCase": {
        "attemptNumber": 1,
        "name": "Log requests with API Keys",
        "result": {
          "duration": 346000000,
          "status": "passed"
        },
        "sourceLocation": {
          "uri": "features/security-test.feature",
          "line": 62
        }
      },
      "testSteps": [
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 29
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "features/support/init.js",
            "line": 7
          },
          "keyword": "Before"
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 37
          },
          "keyword": "Given ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 63
          },
          "text": "I set User-Agent header to apickli",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 67
          },
          "keyword": "And ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 64
          },
          "text": "I set query parameters to",
          "arguments": [
            {
              "rows": [
                [
                  "parameter",
                  "value"
                ],
                [
                  "apikey",
                  "`clientId`"
                ]
              ]
            }
          ]
        },
        {
          "attachments": [],
          "result": {
            "duration": 341000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 91
          },
          "keyword": "When ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 67
          },
          "text": "I GET /logapikey",
          "arguments": []
        },
        {
          "attachments": [],
          "result": {
            "duration": 1000000,
            "status": "passed"
          },
          "actionLocation": {
            "uri": "node_modules/apickli/apickli-gherkin.js",
            "line": 167
          },
          "keyword": "Then ",
          "sourceLocation": {
            "uri": "features/security-test.feature",
            "line": 68
          },
          "text": "response code should be 200",
          "arguments": []
        }
      ]
    }
  ]
}